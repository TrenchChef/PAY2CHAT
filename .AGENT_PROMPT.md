1) NEW ORIGINAL AGENT EXECUTION PROMPT 

You are the engineering agent building PAY2CHAT inside the existing repository:

https://github.com/TrenchChef/PAY2CHAT

Your mission: implement a fully serverless peer-to-peer video chat app with:

WebRTC for P2P audio/video and data channels

Solana USDC for P2P payments

X402 for automatic per-minute billing

No backend. No database. No servers. All logic runs in the browser.
No new tech references beyond the three primitives above.

You must follow the build stages exactly in order, delivering each stage as an incremental PR/commit without rewriting working code.

GLOBAL RULES (MANDATORY)

Extend, don’t rewrite. Never replace working code; layer on top.

Strict sequence. Complete & validate each stage before touching the next.

Atomic PRs. Each stage = one PR (or clean atomic commits).

No backend/servers. Never add server code, APIs, databases, storage, relays, or cloud dependencies.

Pure P2P. All calls, payments, and files are direct user-to-user.

GitHub Pages safe. Keep the build deployable as a static site.

No hallucinated dependencies. Don’t introduce tools or packages unless essential to the three primitives.

Ask only if blocked. Clarify only when a requirement is impossible to interpret.

Stage gate. You must self-test each stage and report pass/fail against its checklist.

Do not modify legal copy after Stage 10.5 unless instructed.

STRICT BUILD ORDER (YOU MUST FOLLOW EXACTLY)
STAGE 1 — WebRTC P2P CALL CORE (NO PAYMENTS)

Implement:

Host/Invitee P2P audio/video connection.

Offer/answer flow with manual signaling (copy/paste text blobs).

Stable DataChannel.

Connection state events + reconnection.

Deliverables:

A dedicated WebRTC core module exposing:

createPeer / createOffer / acceptAnswer / addIce / openDataChannel / sendData

Minimal call test UI for SDP exchange + local/remote video.

Acceptance:

Two browser windows establish a call by SDP copy/paste.

DataChannel sends/receives messages.

Stable ≥10 minutes.

PR title: Stage 1 — WebRTC Core

Stop and wait for merge.

STAGE 2 — Basic Call UI (NO PAYMENTS)

Implement:

Local/remote layout.

Mute/unmute.

Camera toggle.

End call.

Visible connection status.

Acceptance:

Full call lifecycle works cleanly.

No wallet/payment/timer/file work yet.

PR title: Stage 2 — Call UI

STAGE 3 — Wallet Connection (Solana)

Implement:

Connect wallet.

Read wallet address.

Read USDC balance.

Network validation + blocking if wrong.

Acceptance:

Wallet connect stable.

USDC balance visible & correct.

PR title: Stage 3 — Wallet Connect

STAGE 4 — USDC Transfer Engine

Implement:

Low-level function to send USDC Invitee → Host.

Confirmation events.

Clear errors: reject / insufficient funds / network issues.

Acceptance:

Test payment works predictably in-app.

Errors are structured and user-actionable.

PR title: Stage 4 — USDC Transfer

STAGE 5 — Upfront Payment Gate (3 minutes)

Implement:

Invitee must prepay the Host for first 3 minutes before call starts.

Block session start until confirmed.

Acceptance:

Invitee cannot enter call without confirmed prepay.

Host only receives connection after prepay.

PR title: Stage 5 — Upfront Prepay

STAGE 6 — X402 Automatic Per-Minute Billing

Implement:

Automatic USDC charge every 60 seconds via X402.

Billing status exchanged over DataChannel.

On failure: freeze video immediately, allow one retry, else end call.

Acceptance:

Minute billing fires reliably.

Freeze/retry/end logic correct 100% of tests.

PR title: Stage 6 — X402 Autopay

STAGE 7 — Timer / Timekeeping

Implement:

Elapsed call time (mm:ss).

“Next payment in” countdown (mm:ss).

Color states: green paid / yellow <10s / red failure.

Timer accurate even if tab focus changes.

Acceptance:

Timer aligns with billing ticks exactly (no drift).

PR title: Stage 7 — Timer Core

STAGE 8 — Billing + Timer UI Integration

Implement:

Always-visible elapsed clock.

Next-payment countdown.

Per-minute confirmations feed.

Running total paid.

Clear freeze overlay on failed payment.

Acceptance:

UI reflects billing state instantly.

PR title: Stage 8 — Billing UI

STAGE 9 — File Sales (P2P over DataChannel)

Implement:

Host lists files with price.

Invitee buys via USDC using X402.

After confirmation: encrypted chunk transfer over DataChannel.

Invitee reassembles + downloads locally.

Acceptance:

Purchase → transfer → download works for small and large files.

No server involvement.

PR title: Stage 9 — File Sales

STAGE 10 — UI/UX Polish

Implement:

Layout, responsiveness, hierarchy.

Notifications for minute paid + file delivered.

Visual clarity upgrades.

Acceptance:

End-to-end system feels coherent and stable.

PR title: Stage 10 — UI Polish

STAGE 10.5 — Terms of Service (TOS) + Privacy Policy (PP)

New required phase. Generate static legal documents that exactly match PAY2CHAT behavior.

Implement:
Create two static pages in /legal/:

Terms of Service including explicit sections:

18+ requirement

Pure P2P architecture

Users solely responsible for use and transactions

P2P Solana USDC payments + X402 autopay risk disclosure

No refunds / no reversal / no custody

Content responsibility and prohibited use

Files transferred P2P; platform doesn’t store/inspect

“As-is” disclaimers, limitation of liability

Governing law / arbitration (include a reasonable default)

Privacy Policy including:

No server logs or storage

No collection of personal data

Wallet address only used locally for P2P payments

No tracking beyond what the browser itself does

P2P comms not accessible by platform

Deliverables:

/legal/tos.html

/legal/privacy.html

Acceptance:

Both pages render in browser as static docs.

Content accurately describes: P2P calls, P2P payments, autopay, P2P file transfer, no storage.

PR title: Stage 10.5 — Legal Docs

Stop and wait for merge.

STAGE 11 — Consent Modal (Final Step)

Blocking modal before any create/join action.

Modal must:

Block the entire app until accepted.

Include:

18+ certification

Agreement to TOS

Agreement to PP

User responsibility disclaimer

Plain explanation of P2P calls + P2P payments + P2P files + no storage

Provide links:

“View Terms of Service” → /legal/tos.html

“View Privacy Policy” → /legal/privacy.html

Required checkboxes (all mandatory):

“I certify I am 18+.”

“I agree to the Terms of Service.”

“I agree to the Privacy Policy.”

“I understand I am solely responsible for my use and transactions.”

Continue button:

Disabled until all 4 checked.

Text: “Agree and Enter PAY2CHAT”

Store acceptance client-side; if cleared, modal returns.

Acceptance:

No app interaction possible without consent.

Links work.

Language matches final system.

PR title: Stage 11 — Consent Modal

BEGIN EXECUTION

Start at the current incomplete stage only (do not redo merged stages).
Complete that stage, open PR, stop, and await instruction.

5) CURSOR MULTI-AGENT CHAIN PROMPT (ORCHESTRATED)

Paste this into Cursor’s multi-agent / task-graph setup. It assumes a Lead agent that delegates to narrow specialists, then consolidates.

Agents

Lead Architect (A0)

Owns sequencing and PR boundaries.

Enforces “extend-don’t-rewrite” and no-backend rules.

Merges specialist output into a single stage PR.

WebRTC Core Agent (A1)

Implements/extends Stage 1 WebRTC core + DataChannel.

Produces a minimal test harness.

Call UI Agent (A2)

Implements/extends Stage 2 UI only.

Must not touch payments/wallets.

Wallet/USDC Agent (A3)

Implements Stages 3–5 only (wallet connect, USDC transfer, upfront prepay).

Must not touch timers, billing automation, or files.

X402 Billing Agent (A4)

Implements Stage 6 autopay engine + failure freeze behavior.

Uses events compatible with Stage 7 timer.

Timer Agent (A5)

Implements Stage 7 timer core + Stage 8 UI binding, but only after A4 is merged.

File Sales Agent (A6)

Implements Stage 9 file listing + paid transfer over DataChannel.

Must not touch legal docs/modal.

Legal Docs + Consent Agent (A7)

Implements Stage 10.5 (TOS/PP pages) and Stage 11 (modal).

Must not modify core call/payment logic.

Chain Execution Rules

A0 runs first and selects the next incomplete stage.

Only the agent assigned to that stage is activated.

A0 reviews outputs, integrates, runs local checks, and opens PR.

No other agent may proceed until PR is merged.

Agents must operate only within their stage scope.

Task Graph (Strict)

Phase I: P2P Calls

A0 → activate A1 for Stage 1

Merge PR

A0 → activate A2 for Stage 2

Merge PR

Phase II: Wallet + Payments

A0 → activate A3 for Stage 3

Merge PR

A0 → activate A3 for Stage 4

Merge PR

A0 → activate A3 for Stage 5

Merge PR

Phase III: Autopay + Time

A0 → activate A4 for Stage 6

Merge PR

A0 → activate A5 for Stage 7

Merge PR

A0 → activate A5 for Stage 8

Merge PR

Phase IV: Files

A0 → activate A6 for Stage 9

Merge PR

Phase V: Polish + Legal

A0 → implement Stage 10 (or delegate optionally)

Merge PR

A0 → activate A7 for Stage 10.5

Merge PR

A0 → activate A7 for Stage 11

Merge PR
